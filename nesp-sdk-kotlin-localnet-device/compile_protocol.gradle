/*
 * Copyright 2021 NESP Technology.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


// example:
// protoc --proto_path=src --java_out=build/gen/java --kotlin_out=build/gen/kotlin src/foo.proto

final def PROTOC_PATH = '/home/jinzhaolu/bin/protoc/bin/protoc'
final def PROTO_SRC_PATH = 'src/main/kotlin/com/nesp/sdk/kotlin/localnet/device/protocol/'
final def JAVA_OUT = 'src/main/java/'
final def KOTLIN_OUT = ''

task compileProtocol(type: Exec) {
    final def commandLines = [
            PROTOC_PATH, '--proto_path=' + PROTO_SRC_PATH
    ]

    if (!JAVA_OUT.isEmpty()) {
        commandLines.add('--java_out=' + JAVA_OUT)
    }

    if (!KOTLIN_OUT.isEmpty()) {
        commandLines.add('--kotlin_out=' + KOTLIN_OUT)
    }

    commandLines.add(PROTO_SRC_PATH + 'LocalNetDevice.proto')

    commandLine commandLines
}

